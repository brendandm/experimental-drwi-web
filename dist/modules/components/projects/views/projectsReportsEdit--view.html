<div data-ng-include="'/templates/header--view.html'"></div>

<main class="site--content--flow fluid-content clearfix distinguish">

    <div id="sidebar" data-ng-include="'/templates/side-bar.html'"></div>

    <div class="content--container" style="border-right: 1px solid #e0e0e0;">

        <div class="progress--modal reveal fade-in t0" data-ng-if="page.status.loading">
            <div class="progress--container">
                <p style="font-weight: bold;" class="color-pulse">Loading sites&hellip;</p>
            </div>
        </div>

        <section class="privacy-message reveal fade-in t0" data-ng-if="!page.status.loading && page.makePrivate">

            <p>
                <i class="material-icons">
                    lock
                </i>
            </p>

            <p>This project is private.</p>

        </section>

        <h1 class="inset" data-ng-if="!page.status.loading && !page.makePrivate">
            Edit Report</h1>

        <div class="main--ui reveal fade-in t0" data-ng-if="!page.status.loading && !page.makePrivate">

            <section class="reveal fade-in t3" style="padding: 0;">

                <div class="feature-detail-content"
                     style="
                        border:     0px solid red;
                        margin:     0 auto;
                      /*  max-width:766px;*/
                        width:      100%;
                        float:      left;
                        display:    block;
                    ">

                     <h2>Reporting to {{page.bundle.program.name}}</h2>

                    <div style="
                                border:1px solid blue;
                                display:block;
                                width: 100%;
                              "
                    >

                         <form data-ng-submit="page.saveReport()"
                          class="form" role="form"
                          autocomplete="off"
                          style="
                            border      : 1px solid purple;
                            width       : 100%

                            max-width   : 100%
                            margin:     : 0 auto;"
                        >

                            <!--
                             <h2>
                                Report date and measurement period
                            </h2>
                            -->
                            <div class="form-element">
                                <span class="meta-label"><b>Title</b></span>
                                <input id="report_title" name="report_date_month" type="text" value="page.bundle.title" data-ng-model="page.bundle.title" >
                            </div>

                            <div style="display:block; border: 0px solid green;">

                                <div class="form-element" style="
                                    border:0px solid red;
                                    width: 31.1111%;
                                    float: right;
                                    display:inline-block;"
                                >
                                    <span class="meta-label"><b>Year</b></span>
                                    <input number type="number" min="1900" step="1" id="report_date_year" name="report_date_year" data-ng-model="page.date.year" />
                                </div>

                                <div class="form-element" style="
                                    border:0px solid red;
                                    width: 31.1111%;
                                    margin-left:3.3333%;
                                    margin-right:3.3333%;
                                    float: right;
                                    display:inline-block;"
                                >
                                    <span class="meta-label"><b>Month</b></span>
                                    <input id="report_date_month" name="report_date_month" type="text" value="page.date.month" data-ng-model="page.date.month" uib-typeahead="month.name for month in page.months | filter:$viewValue | limitTo:5" typeahead-min-length="0" typeahead-template-url="templates/search--tpl.html" required="required">
                                </div>

                                <div class="form-element" style="
                                        border:0px solid red;
                                        width: 31.1111%;
                                        float: right;
                                        display:inline-block;"
                                >
                                    <span class="meta-label"><b>Day</b></span>
                                    <input type="number" min="1" max="31" step="1" id="report_date_date" name="report_date_date" data-ng-model="page.date.date" />
                                </div>

                            </div>

                            <div class="form-element" style="
                               clear:left;
                               float:right;
                               display: inline-block;
                               border: 0px solid purple;">
                                <span class="meta-label" style="display: block;"><b>Notes</b></span>
                                <textarea class="form-control" msd-elastic data-ng-model="page.bundle.notes" maxlength="1000" rows="10">{{ page.report.notes }}</textarea>
                                <p style="color: #616161; font-size: 0.9em; font-style: normal; margin-top: 0.5em;">
                                    Notes may contain up to 1,000 characters, including spaces and punctuation. <strong>({{ (page.report.notes.length || 0) | number }} used)</strong>
                                </p>
                            </div>

                         </form>

                    </div>

                    <div style="
                                position: relative;
                                display:block;
                                float:left;
                                clear: both;
                            "
                    >

                        <h2>Practices</h2>
                        <p>
                            Showing <b>{{ siteList.length }}</b> of <b>{{ page.availableFeatures.length }}</b> total practices in project <b>{{page.project.name}}</b>.
                        </p>
                          <div class="collection-search reveal fade-in t0" style="border: 0px solid red;
                                                                            justify-content:left;
                                                                            align-items:left;
                                                                            overflow: auto;
                                                                            flex-wrap: wrap;
                                                                            width:100%;
                                                                             " >

                            <input style="float:left; display:inline-block; clear:right; width:100%;" type="text" class="search-bar list-filter" data-ng-if="!page.status.loading" data-ng-model="page.queryToken" placeholder="Search your practices">

                          </div>

                    </div>

                </div>



            </section>

            <!-- Unselected Sites -->
            <section class="reveal fade-in t3" style="padding: 0;" data-ng-if="page.permissions.can_edit">









                <ul class="snapshot--cards list-unstyled">

                        <li class="card" data-ng-repeat="practice in page.practices | orderBy:'name':false">

                            <div class="card--content">

                                <div style="position:relative;">

                                  <img data-ng-if="practice.staticURL" data-ng-src="{{ practice.staticURL }}" width="auto" height="auto" />


                                    <img data-ng-if="!practice.staticURL" data-ng-src="https://api.mapbox.com/styles/v1/mapbox/streets-v10/static/-98.5795,39.828175,5/400x200@2x?access_token=pk.eyJ1IjoiYm1jaW50eXJlIiwiYSI6IjdST3dWNVEifQ.ACCd6caINa_d4EdEZB_dJw" width="auto" height="auto" />


                                    <!--<div id="site-geography-preview-{{ $index }}" style="width: 100%; height: 200px;"></div>-->


                                    <!-- <leaflet id="site-geography-preview-{{ $index }}" style="width: 100%; height: 200px;" defaults="page.previewMap.defaults" layers="page.previewMap.layers" bounds="site.bounds" geojson="site.geojson"></leaflet> -->

                                </div>

                                <div class="name" style="background: #fff;">
                                    <span>{{ practice.name || 'Un-named' }}</span>
                                </div>

                                <div class="body">


                                <!--
                                    <div class="confirm--delete" data-ng-if="page.deletionTarget && page.deletionTarget.feature.properties.id === site.properties.id && page.deletionTarget.collection === 'site'">
                                        <p>Do you want to delete this site?</p>
                                        <div class="actions" style="flex: 0;">
                                            <a class="snapshot--title" href="#" title="Delete forever" data-ng-click="page.deleteFeature('site', $index)">
                                                Yes
                                            </a>
                                            <a class="snapshot--title" href="#" title="Cancel" data-ng-click="page.cancelDelete()">
                                                Cancel
                                            </a>
                                        </div>
                                    </div>
                                  -->
                                    <p>{{ (practice.description || 'No description') | truncate:80 }}</p>

                                     <div class="collection-filter-group">
                                        <button  ng-if="practice.report"
                                                 data-ng-click="page.showPracticeModal(practice.id)"
                                                 title="add data to practice {{practice.name}}"
                                                style="
                                                    margin: 0 auto;
                                                    background-color:#29cc82;
                                                    color: #ffffff;
                                                    width: 156px;
                                                    text-align: center;
                                                  "
                                        >

                                            <span
                                                  style="
                                                    text-align: center;
                                                    border:0px solid pink;
                                                    margin: 0 auto;
"
                                            >
                                                <nobr>Edit Metric Data</nobr>

                                            </span>


                                        </button>
                                         <button ng-if="!practice.report"
                                                  data-ng-click="page.showPracticeModal(practice.id)"
                                                  title="add data to practice {{practice.name}}"
                                                style="
                                                    margin: 0 auto;

                                                    background-color: #3299cb;

                                                    color: #ffffff;
                                                    width: 156px;
                                                    text-align: center;
                                                  "
                                         >


                                             <span
                                                  style="
                                                    text-align: center;
                                                    border:0px solid pink;
                                                    margin: 0 auto;

                                                    "
                                            ><nobr>Add Metric Data</nobr></span>
                                        </button>




                                    </div>

                                    <div class="actions">
                                        <a class="snapshot--title" href="/practices/{{ practice.id }}" title="Site summary">
                                            <i class="material-icons">
                                                dashboard
                                            </i>
                                        </a>
                                        <a class="snapshot--title" href="/practices/{{ practice.id }}/edit" title="Edit site" data-ng-if="page.permissions.can_edit">
                                            <i class="material-icons">
                                                edit
                                            </i>
                                        </a>
                                        <a class="snapshot--title" href="/practices/{{ practice.id }}/location" title="Edit location" data-ng-if="page.permissions.can_edit">
                                            <i class="material-icons">
                                                location_on
                                            </i>
                                        </a>
                                        <a class="snapshot--title" href="#" title="Delete site" data-ng-click="page.confirmDelete(site, 'site')" data-ng-if="page.permissions.can_edit">
                                            <i class="material-icons">
                                                delete
                                            </i>
                                        </a>
                                    </div>
                                    <span><time datetime="{{ practice.modified_on }}" title="{{ practice.modified_on }}">Last updated on {{ site.properties.modified_on | date : 'mediumDate' }}</time></span>
                                </div>

                            </div>
                        </li>


                </ul>

            </section>

            <!--
            MODAL
            -->

            <div class="metric-modal"
                 data-ng-if="page.displayModal"
                 style="

                        overflow-y:auto;
                        overflow-y:scroll;
                        border: 1px solid green;"

            >
                 <!--   display:block; -->
            <!--   data-ng-click="page.closePracticeModal()" -->

                <div  class="modal-wrapper" style="

                    "
                >

                    <div id="modalScroll" class="summary-card"
                         style="max-width:80%;">

                         <h2>
                            Reporting to {{page.bundle.program.name}}
                        </h2>
                         <h2>
                            Reporting to {{page.selectedPractice.name}}
                        </h2>

            <!--  position:fixed; -->


                         <form data-ng-submit="page.saveReport()" class="form" role="form" autocomplete="off">

                        <h2>
                            Report date and measurement period
                        </h2>

                        <div class="form-element">
                            <span class="meta-label"><b>Month</b></span>
                            <input id="report_date_month" name="report_date_month" type="text" value="page.date.month" data-ng-model="page.date.month" uib-typeahead="month.name for month in page.months | filter:$viewValue | limitTo:5" typeahead-min-length="0" typeahead-template-url="templates/search--tpl.html" required="required">
                        </div>

                        <div class="form-element">
                            <span class="meta-label"><b>Date</b></span>
                            <input type="number" min="1" max="31" step="1" id="report_date_date" name="report_date_date" data-ng-model="page.date.date" />
                        </div>

                        <div class="form-element">
                            <span class="meta-label"><b>Year</b></span>
                            <input number type="number" min="1900" step="1" id="report_date_year" name="report_date_year" data-ng-model="page.date.year" />
                        </div>

                        <div>

                            <div class="form-element">

                                <div class="form-element">
                                    <span class="meta-label"><b>Practice area</b></span>
                                    <input class="form-control" data-ng-model="page.selectedPractice.practice_extent" id="practice_extent" name="practice_extent" step="0.0001" type="number" placeholder="0" />
                                </div>

                                <div class="form-element">
                                    <span class="meta-label"><b>Area units</b></span>
                                    <input type="text" class="form-control" id="email" name="email" disabled="disabled" value="acres" required="required" readonly />
                                    <p style="color: #9e9e9e; font-size: 0.9em; font-style: normal; margin-top: 0.5em;">
                                        Practice area is standardized to acres.
                                    </p>
                                </div>

                            </div>

                        </div>

                        <h2>Implementation progress</h2>

                        <div style="margin: 0 0 4em;">

                            <p style="font-style: normal; font-size: 1em; color: #616161;">The metrics listed here are associated with the <strong>{{ page.selectedPractice.name }}</strong> practice. Track implementation by entering a numeric value for one or more metrics. If you try to add a progress value that exceeds a metric’s baseline practice value, FieldDoc will cap the site target’s value for you.</p>

                            <br />

                            <ul class="target-lst" data-ng-if="page.targets && page.targets.active.length">
                                <li data-ng-repeat="target in page.targets.active">
                                    <div>{{ target.metric.name || target.name }}</div>
                                    <input type="text" class="form-control" data-ng-model="target.target" id="target-active-{{ $index }}" name="target-active-{{ $index }}" placeholder="0" autocomplete="off" disabled="disabled" readonly />
                                    <input type="number" class="form-control" data-ng-model="target.value" id="name-active-{{ $index }}" name="name-active-{{ $index }}" placeholder="0" step="0.0001" min="0" autocomplete="off" />
                                    <button type="button" class="add-item" data-ng-click="page.removeTarget(target, $index)" data-ng-disabled="page.status.processing">
                                        <i class="material-icons">
                                            remove_circle
                                        </i>
                                    </button>
                                </li>
                            </ul>

                            <ul class="target-lst">
                                <li style="justify-content: flex-end; margin-top: 2em; border-top: 1px solid #e0e0e0; padding-top: 1em;">
                                    <button type="button" class="add-item" data-ng-click="page.removeAll()" data-ng-disabled="page.status.processing">
                                        <i class="material-icons">
                                            delete_sweep
                                        </i>
                                    </button>
                                    <button type="button" class="add-item" style="margin-left: 1em;" data-ng-click="page.saveTargets()" data-ng-disabled="page.status.processing">
                                        <i class="material-icons">
                                            done
                                        </i>
                                    </button>
                                </li>
                            </ul>

                            <ul class="target-lst target-lst-inactive" data-ng-if="page.targets">
                                <li data-ng-repeat="target in page.targets.inactive">
                                    <div>{{ target.name || target.metric.name }}</div>
                                    <input type="text" class="form-control" data-ng-model="target.target" id="target-inactive-{{ $index }}" name="target-inactive-{{ $index }}" placeholder="0" autocomplete="off" disabled="disabled" readonly />
                                    <input type="number" class="form-control" data-ng-model="target.value" id="name-inactive-{{ $index }}" name="name-inactive-{{ $index }}" placeholder="0" step="0.0001" min="0" autocomplete="off" />
                                    <button type="button" class="add-item" data-ng-click="page.addTarget(target, $index)" data-ng-disabled="page.status.processing">
                                        <i class="material-icons">
                                            add_circle
                                        </i>
                                    </button>
                                </li>
                            </ul>

                        </div>

                        <div class="form-element">
                            <span class="meta-label"><b>Notes</b></span>
                            <textarea class="form-control" msd-elastic data-ng-model="page.report.notes" maxlength="1000" rows="10">{{ page.report.notes }}</textarea>
                            <p style="color: #616161; font-size: 0.9em; font-style: normal; margin-top: 0.5em;">
                                Notes may contain up to 1,000 characters, including spaces and punctuation. <strong>({{ (page.report.notes.length || 0) | number }} used)</strong>
                            </p>
                        </div>

                        <div class="save--action--wrapper save--action--bottom">
                            <button type="submit" data-ng-disabled="page.status.processing">
                                <i class="material-icons" data-ng-if="page.status.processing">
                                    more_horiz
                                </i>
                                <i class="material-icons" data-ng-if="!page.status.processing">
                                    done
                                </i>
                            </button>
                        </div>

                    </form>


                    </div>

                     <a class="summary-card close" type="button" data-ng-click="page.closePracticeModal()" title="Cancel"
                                style="
                                        position:   relative;
                                        display:    block;
                                        float:      right;
                                        width:      10px;
                                        height:     10px;
                                        border:     0px solid white;
                                      "
                        >
                            <i class="material-icons">
                                clear
                            </i>
                    </a>


                </div>

            </div>

            <!--
            END MODAL
            -->



        </div>

    </div>

    <nav id="toolbar" class="toolbar" style="float: none; width: auto;" data-ng-if="$root.user.id">
        <ul>
            <li data-ng-class="{active: $root.toolbarState.dashboard}">
                <a href="/projects/{{ page.project.id }}">
                    <i class="material-icons">
                        dashboard
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <a href="/projects/{{ page.project.id }}/edit">
                    <i class="material-icons">
                        edit
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.grant}">
                <a href="/projects/{{ page.project.id }}/grant">
                    <i class="material-icons">
                        account_balance
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <a href="/projects/{{ page.project.id }}/users">
                    <i class="material-icons">
                        group
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.partnerships}">
                <a href="/projects/{{ page.project.id }}/partnerships">
                    <i class="material-icons">
                        group_work
                    </i>
                </a>
            </li>
            <!-- <li data-ng-if="page.permissions.can_edit">
                <a href="/projects/{{ page.project.id }}/edit">
                    <i class="material-icons">
                        edit
                    </i>
                </a>
            </li> -->
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTargets}">
                <a href="/projects/{{ page.project.id }}/targets">
                    <i class="material-icons">
                        multiline_chart
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTags}">
                <a href="/projects/{{ page.project.id }}/tags">
                    <i class="material-icons">
                        local_offer
                    </i>
                </a>
            </li>
     <!--       <li data-ng-if="page.permissions.can_edit">
                <a href="#" data-ng-click="page.print()">
                    <i class="material-icons">
                        print
                    </i>
                </a>
            </li>
            -->
            <li data-ng-if="page.permissions.can_edit">
                <div class="confirm--delete--popup" data-ng-if="page.deletionTarget">
                    <p>Do you want to delete this site?</p>
                    <div class="actions">
                        <a class="snapshot--title" href="#" title="Delete forever" data-ng-click="page.deleteFeature()">
                            Yes
                        </a>
                        <a class="snapshot--title" href="#" title="Cancel" data-ng-click="page.cancelDelete()">
                            Cancel
                        </a>
                    </div>
                </div>
                <a href="#" data-ng-click="page.confirmDelete(page.site)">
                    <i class="material-icons">
                        delete
                    </i>
                </a>
            </li>
        </ul>
    </nav>

    <div class="transient--notification" data-ng-class="{show: page.alerts.length}">
        <div class="event--container">
            <div data-ng-repeat="alert in page.alerts" data-ng-class="{error: alert.type == 'error', success: alert.type == 'success'}">
                <span class="event--message">{{ alert.msg }}</span>
            </div>
        </div>
    </div>

</main>

<div data-ng-include="'/templates/footer--view.html'"></div>